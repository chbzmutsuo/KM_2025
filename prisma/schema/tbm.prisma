model TbmBase {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 name String @unique

 User             User[]
 TbmVehicle       TbmVehicle[]
 TbmRouteGroup    TbmRouteGroup[]
 // TbmOperationGroup TbmOperationGroup[]
 TbmDriveSchedule TbmDriveSchedule[]
}

model TbmVehicle {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 name  String
 plate String @unique

 // TbmOperationGroup TbmOperationGroup[]
 TbmRefuelHistory TbmRefuelHistory[]
 TbmBase          TbmBase            @relation(fields: [tbmBaseId], references: [id], onDelete: Cascade)
 tbmBaseId        Int
 TbmDriveSchedule TbmDriveSchedule[]
 OdometerInput    OdometerInput[]
}

model TbmRouteGroup {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 name             String
 TbmBase          TbmBase            @relation(fields: [tbmBaseId], references: [id], onDelete: Cascade)
 tbmBaseId        Int
 // TbmOperation     TbmOperation[]
 TbmDriveSchedule TbmDriveSchedule[]

 TbmCustomer   TbmCustomer? @relation(fields: [tbmCustomerId], references: [id], onDelete: Cascade)
 tbmCustomerId Int?

 TbmMonthlyConfigForRouteGroup TbmMonthlyConfigForRouteGroup[]
}

model TbmMonthlyConfigForRouteGroup {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 yearMonth DateTime

 pickupTime  String? //接車時間
 vehicleType String? //車種

 TbmProduct   TbmProduct? @relation(fields: [tbmProductId], references: [id], onDelete: Cascade)
 tbmProductId Int?

 postalFee        Int? //通行量(郵便)
 postalHighwayFee Int? //高速(郵便)

 generalFee        Int? //通行量（一般）
 generalHighwayFee Int? //高速（一般）

 driverFee       Float?
 billingFee      Float?
 tollFee         Float?
 numberOfTrips   Int?
 TbmRouteGroup   TbmRouteGroup @relation(fields: [tbmRouteGroupId], references: [id], onDelete: Cascade)
 tbmRouteGroupId Int

 @@unique([yearMonth, tbmRouteGroupId], name: "unique_yearMonth_tbmRouteGroupId")
}

model TbmProduct {
 id                            Int                             @id @default(autoincrement())
 createdAt                     DateTime                        @default(now())
 updatedAt                     DateTime?                       @default(now()) @updatedAt()
 sortOrder                     Float                           @default(0)
 code                          String                          @unique
 name                          String                          @unique
 TbmMonthlyConfigForRouteGroup TbmMonthlyConfigForRouteGroup[]
}

model TbmBillingAddress {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 name String
 // TbmRoute TbmRoute[]
}

// model TbmRoute {
//  id        Int       @id @default(autoincrement())
//  createdAt DateTime  @default(now())
//  updatedAt DateTime? @default(now()) @updatedAt()
//  sortOrder Float     @default(0)

//  departure           String
//  destination         String
//  farePrice           Float?
//  tollPrice           Float?
//  driverSalary        Float?
//  TbmBillingAddress   TbmBillingAddress @relation(fields: [tbmBillingAddressId], references: [id], onDelete: Cascade)
//  tbmBillingAddressId Int

//  TbmRouteGroup   TbmRouteGroup? @relation(fields: [tbmRouteGroupId], references: [id], onDelete: Cascade)
//  tbmRouteGroupId Int?
// }

// model TbmOperationGroup {
//  id        Int       @id @default(autoincrement())
//  createdAt DateTime  @default(now())
//  updatedAt DateTime? @default(now()) @updatedAt()
//  sortOrder Float     @default(0)

//  fuelOwn   Float?
//  fuelOther Float?
//  confirmed Boolean @default(false)

//  TbmVehicle   TbmVehicle     @relation(fields: [tbmVehicleId], references: [id], onDelete: Cascade)
//  User         User           @relation(fields: [userId], references: [id], onDelete: Cascade)
//  TbmBase      TbmBase        @relation(fields: [tbmBaseId], references: [id], onDelete: Cascade)
//  TbmOperation TbmOperation[]

//  tbmVehicleId     Int
//  userId           Int
//  tbmBaseId        Int
//  TbmRefuelHistory TbmRefuelHistory[]
// }

// model TbmOperation {
//  id        Int       @id @default(autoincrement())
//  createdAt DateTime  @default(now())
//  updatedAt DateTime? @default(now()) @updatedAt()
//  sortOrder Float     @default(0)

//  date          DateTime
//  distanceKm    Float?
//  TbmRouteGroup TbmRouteGroup @relation(fields: [tbmRouteGroupId], references: [id], onDelete: Cascade)

//  TbmOperationGroup TbmOperationGroup @relation(fields: [tbmOperationGroupId], references: [id], onDelete: Cascade)
//  User              User?             @relation(fields: [userId], references: [id], onDelete: Cascade)

//  TbmInvoiceDetail TbmInvoiceDetail[]

//  tbmRouteGroupId     Int
//  tbmOperationGroupId Int
//  userId              Int?
//  type                String

//  @@unique([tbmRouteGroupId, type], name: "unique_tbmRouteGroup_type")
// }

model TbmInvoiceDetail {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 // TbmOperation    TbmOperation @relation(fields: [tbmOperationId], references: [id], onDelete: Cascade)
 // tbmOperationId  Int
 numberOfTrips   Int
 fare            Float
 toll            Float
 specialAddition Float? // 特別付加金
}

model TbmCustomer {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 customerName    String
 address         String?
 phoneNumber     String?
 faxNumber       String?
 bankInformation String?
 TbmRouteGroup   TbmRouteGroup[]
}

model TbmRefuelHistory {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 date     DateTime
 amount   Float
 odometer Float
 type     String

 // TbmOperationGroup TbmOperationGroup? @relation(fields: [tbmOperationGroupId], references: [id], onDelete: Cascade)
 // tbmOperationGroupId Int?

 TbmVehicle TbmVehicle @relation(fields: [tbmVehicleId], references: [id], onDelete: Cascade)

 tbmVehicleId Int
}

// model TbmUserDate {
//  id        Int       @id @default(autoincrement())
//  createdAt DateTime  @default(now())
//  updatedAt DateTime? @default(now()) @updatedAt()
//  sortOrder Float     @default(0)

//  Calendar      Calendar @relation(fields: [tbmCalendarId], references: [id],onDelete: Cascade)
//  tbmCalendarId Int

//  User   User @relation(fields: [userId], references: [id],onDelete: Cascade)
//  userId Int

//  TbmDriveSchedule TbmDriveSchedule[]

//  @@unique([userId, tbmCalendarId], name: "unique_userId_tbmCalendarId")
// }

model TbmDriveSchedule {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 // TbmUserDate   TbmUserDate @relation(fields: [tbmUserDateId], references: [id],onDelete: Cascade)
 // tbmUserDateId Int

 date DateTime

 User   User @relation(fields: [userId], references: [id], onDelete: Cascade)
 userId Int

 TbmVehicle   TbmVehicle @relation(fields: [tbmVehicleId], references: [id], onDelete: Cascade)
 tbmVehicleId Int

 TbmRouteGroup   TbmRouteGroup @relation(fields: [tbmRouteGroupId], references: [id], onDelete: Cascade)
 tbmRouteGroupId Int

 finished  Boolean? @default(false)
 TbmBase   TbmBase  @relation(fields: [tbmBaseId], references: [id])
 tbmBaseId Int
}

model OdometerInput {
 id        Int       @id @default(autoincrement())
 createdAt DateTime  @default(now())
 updatedAt DateTime? @default(now()) @updatedAt()
 sortOrder Float     @default(0)

 odometerStart Float
 odometerEnd   Float
 date          DateTime

 // TbmDriveSchedule   TbmDriveSchedule @relation(fields: [tbmDriveScheduleId], references: [id], onDelete: Cascade)
 // tbmDriveScheduleId Int

 TbmVehicle   TbmVehicle @relation(fields: [tbmVehicleId], references: [id], onDelete: Cascade)
 tbmVehicleId Int

 // @@unique([tbmDriveScheduleId, tbmVehicleId], name: "unique_tbmDriveScheduleId_tbmVehicleId")
 @@unique([tbmVehicleId, date], name: "unique_tbmVehicleId_date")
}
