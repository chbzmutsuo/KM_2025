# WEBアプリ要件定義書

学校向けスライド授業支援アプリ「colabo」

---

## 背景・前提

- `/app/(apps)/edu/Grouping` アプリが既存で存在する
- 新規に `/app/(apps)/edu/colabo` アプリを作成
- colabo は Grouping.prisma で定義されたテーブルを共有利用

### 共通事項

- 授業単位は `Game`
  - 教師が Game を作成
  - 生徒を招待（QRコード経由）
  - 教師がスライドを作成し、授業開始
- Grouping と同様に以下の特徴を引き継ぐ
  - 心理アンケート結果による自動グループ分け
  - 第1回／第2回アンケート差分によるランキング表示
  - 下記で示す「テンプレート」の一つとしてアンケートが実施される。

---

## 1. 目的

- インタラクティブなスライド授業を実現する
- 教師の端末操作が生徒端末に即時反映
- 生徒のインタラクティブな回答が即時反映
- 回答データはDB保存（分析機能は現段階では未実装）

---

## 2. 機能要件

### 2.1 スライド編集機能（ノーマルモード）

- スライド単位の **ブロック構成**
- オブジェクト種別
  - テキスト（Markdown対応）
  - 画像
  - リンク
- デザイン調整
  - 配置（左右／中央、上下）
  - 色／背景色
  - フォント装飾（ボールド、アンダーライン）

### 2.2 テンプレート一覧

| テンプレート名   | 機能概要                            |
| ---------------- | ----------------------------------- |
| ノーマル         | 授業資料用スライド                  |
| 心理アンケート   | 生徒回答 → 教師確認 → 自動班編成    |
| 選択クイズ       | 問題＋選択肢 → 生徒回答 → 棒グラフ  |
| 自由記述クイズ   | 問題＋自由記述 → 回答共有可         |
| まとめアンケート | 心理アンケート類似 → ランキング表示 |

### 2.3 インタラクティブ回答機能

### 心理アンケートモード

- 生徒
  - 心理アンケート回
  - 回答後：「全員の回答が終わるまで待機」画面表示
- 教師
  - 回答状況確認
  - 強制締切可能
  - 自動班編成（Grouping の仕組みを踏襲）
  - 学習班はノーマルモード移行後も表示

### 選択クイズ

- 教師
  - 1スライド1問構成
  - 選択肢数無制限（画像・テキスト対応）
  - 棒グラフで回答傾向表示
  - 正答判定（複数選択も可）→ 生徒画面反映
- 生徒
  - 選択肢から回答

### 自由記述クイズ

- 教師
  - 問題作成
  - 回答一覧表示 → 特定回答を生徒画面に共有
- 生徒
  - 自由記述で回答

### まとめアンケート

- アンケートの実施とランキング表示はGrouping 同様の設計
- 質問項目は心理アンケートと同等

---

## 3. 操作フロー

| ステップ | 教師の操作               | 生徒の操作             |
| -------- | ------------------------ | ---------------------- |
| 1        | スライド作成             | -                      |
| 2        | Game作成 → QRコード発行  | QRコード読み取り／参加 |
| 3        | 授業開始 → スライド進行  | スライド閲覧／回答     |
| 4        | 回答収集                 | 回答入力（選択・記述） |
| 5        | 結果表示・次スライド進行 | 結果閲覧               |
| 6        | 授業終了                 | -                      |

---

## 4. データ保存仕様

- 単位：`Game` ごとにセッション保存

### 保存対象例

- セッション情報
  - 日時
  - 教師
  - クラス情報
  - 使用テンプレート構成
- スライド内容
  - ノーマル・テンプレート別構成
  - 編集履歴
- 生徒回答データ
  - 選択肢
  - 自由記述
  - 心理アンケート結果
- 学習班編成結果
- 集計結果
  - ランキング
  - 棒グラフ等

### 参照機能

- 教師
  - 過去授業セッション参照
  - データのCSV／PDFエクスポート（任意）

---

## 5. 技術スタック・アーキテクチャ方針

### 5.1 使用技術

- フロントエンド: Next.js + Tailwind CSS
- データベース: PostgreSQL
- ORM: Prisma

### 5.2 プロジェクト構造

- **マイクロフロントエンド構成**
  - `/app/(apps)/xxx` 配下に独立アプリ配置
  - 各アプリは独立運用（rootApp）
  - ただし、Groupingとcolaboは/app/(apps)/eduの配下で並列稼働。

### 5.3 バックエンド設計

- **Server Actions 優先**
  - APIより Server Actions 使用推奨
  - 配置: `/app/(apps)/{アプリ名}/actions/`
  - 命名規則: `{機能名}__{アクション名}`
    - 例：`auth__login`、`user__register`
  - ファイルサイズ／画像アップロード時のみAPI使用許可

### 5.4 Prisma スキーマ方針

- リレーション名は相手テーブル名（先頭大文字）
  - 例: `User.Store`
  - 複数形は使用禁止
- 日付データ方針
  - ISO形式 `YYYY-MM-DDTHH:MM:SSZ`
  - 時間が分かれる場合は文字列管理 `"HH:mm"`

---

## 6. コーディング／ディレクトリ方針

- 関数は **アロー関数** 原則
  - function 宣言は特別な必要性時のみ
- **ファイル分割厳守**
  - Helper、Actions、Component等は機能単位で分割
- ページ固有のComponentやHelperは該当ページ配下に配置
  - 例：`/app/(apps)/myApp/user/components/`

---
