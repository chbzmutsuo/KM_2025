仕出し弁当管理システム 要件定義書

1. システム概要
   • 本システムは、仕出し弁当の注文、予約、顧客、商品、配達、売上管理を行うWebアプリケーションとして構築されます。
   • URLからのアクセスを基本とし、スマートフォン（iPhone、Android問わず）およびパソコンで利用可能です。
   • 利用形態としては、Webブラウザからのアクセスだけでなく、ホーム画面に設置することでネイティブアプリのように利用できるPWA（Progressive Web App）形式での利用も可能です。
2. マスタデータ管理
   2.1. 顧客マスタ
   • 顧客情報を管理するページを設けます。
   • 新規作成、編集、削除機能を提供します。
   • 顧客データ項目:
   ◦ 顧客名
   ◦ 電話番号: 必須項目であり、システム内で重複しないことを前提とします。
   ▪ 入力時はハイフンを含まない半角数字で入力し、表示時には適切な位置にハイフンを自動挿入します。
   ▪ 予約時に電話番号を入力すると、既存顧客データがあれば自動で情報を取得します。
   ▪ 新規顧客の場合は、予約時に基本情報を入力することで新規登録を行います。
   ◦ 住所:
   ▪ 郵便番号からの住所自動入力機能を実装します。
   ◦ 会社名: 顧客情報として管理します。
   • 予約時における顧客情報更新の選択機能:
   ◦ 予約作成時に、顧客マスタの住所を予約時の情報に更新するかどうかを「はい／いいえ」で選択できるポップアップを表示します。
   ◦ 「はい」を選択した場合、顧客マスタの情報が予約時の情報で更新されます。
   ◦ 「いいえ」を選択した場合、顧客マスタの情報は更新されません。
   2.2. 商品マスタ
   • 商品情報を管理するページを設けます。
   • 新規作成、編集、削除機能を提供します。
   • 商品データ項目:
   ◦ 商品名
   ◦ 原価: 履歴管理（変動履歴の管理）を行います。
   ◦ 販売価格: 履歴管理（変動履歴の管理）を行います。
   • 「パック」や「セット」としての商品の登録は行わず、セット売りの場合も個々の商品を単品として売上登録する運用とします。
   • 単位（例: 個、本）の登録は不要です。
   • 「袋」も商品として登録し、単価を設定できるようにします。
   2.3. ユーザーマスタ
   • ユーザー情報（受付担当者など）を管理するページを設けます。
   • ユーザーデータ項目:
   ◦ 名前
   ◦ 電話番号
   ◦ 住所
   • その他、現時点では追加管理項目は不要です。
3. 予約・注文管理
   3.1. 予約一覧画面（メイン画面）
   • 予約のリストを表示するメイン画面です。
   • 新規作成ボタンを設置します。
   • 伝票印刷ボタン（緑色のマーク）を設置し、伝票作成画面へ遷移できるようにします。
   • 検索・絞り込み機能:
   ◦ 予約一覧ページに検索窓を設置し、別の検索抽出シートは不要とします。
   ◦ **表示範囲の初期値は当日（今日の予約）**とし、日付指定で期間を変更して過去の予約も表示できるようにします。
   ◦ 検索フィルター条件:
   ▪ 商品名
   ▪ 担当スタッフ名
   ▪ お客様名
   ▪ 会社名
   ◦ 複数のフィルター条件を重ねて絞り込み表示が可能です。
   • 過去の注文履歴: 予約一覧画面または検索結果から、お客様の過去の注文履歴を確認できるようにします。
   3.2. 予約作成画面
   • 顧客情報入力:
   ◦ 電話番号を入力すると、既存の顧客情報が自動で表示されます。
   ◦ 配達先が顧客マスタの登録住所と異なる場合でも、手動で変更・入力が可能です。
   • 予約情報入力:
   ◦ 納品日、納品時間
   ◦ 注文経路（電話、Web、店頭など）
   ◦ 用途（会議、お祝い事など）
   ◦ 商品選択と個数入力
   ◦ 合計金額表示
   ◦ ポイント使用の登録
   ◦ 支払い方法
   ◦ 袋の個数と金額
   ◦ 受付担当者名
   • 受け取り方法の選択:
   ◦ 「店舗受け取り」か「配達」かを選択する項目を追加します。
   ◦ この選択は、伝票印刷および配達ルート最適化の対象かどうかの判断に利用されます。
   • 履歴管理: 予約注文の新規作成、更新、削除に関する履歴を全て記録します。
   ◦ 変更した担当者を記録しますが、端末が1台の場合、自己申告ベースでの登録となります。
4. 配達管理・ルート最適化
   • 当日（または選択した日付）の注文リストをN個のチームに割り振る機能を実装します。
   ◦ 事前にチーム分けを行い（前日に行うことを想定）、割り振られたデータはデータベースに保存されます。
   ◦ 割り振り方法は、チェックボックスなどで対象を選択しチームに割り振る形式を想定します。
   • 各チームに対してGoogle Map APIと連携し、最適な配送順序（最短ルート）を表示します。
   • 各配達先のクリックでGoogleマップ（Webブラウザ版またはインストール済みアプリ）を開けるようにします。
   • チーム未所属の注文がある場合の警告表示機能を実装します（例: 新規注文が追加された場合など）。
   • 配達ルート最適化は「店舗受け取り」の注文は対象外とします。
5. 帳票出力・レポート機能
   5.1. 伝票印刷
   • 伝票作成画面へ遷移し、印刷可能です。
   • 選択した日付の全伝票を一括印刷できる機能を実装します。
   ◦ 多数の伝票（例: 30-40件）を一括印刷した場合、表示までに時間がかかる可能性があります。
   • 印刷される伝票は、Webブラウザの印刷機能を利用し、URLなどの不要な情報が出ないよう整形されます。
   • 伝票フォーマット:
   ◦ A4サイズで、1枚に2伝票（上半分と下半分）が印刷される形式とします。
   ◦ 配達、店舗受け取り問わず、全ての注文で伝票を2枚ずつ出力できるようにします。
   ◦ 記載される情報: 住所、納品日など、注文に関する全ての内容。
   5.2. ダッシュボード・集計画面
   • 日付を指定して集計情報を表示できるダッシュボード機能を実装します。
   • 表示する主な情報:
   ◦ 総売上
   ◦ 粗利合計
   ◦ 予約合計数
   ◦ 平均客単価
   ◦ 売上明細（用途と金額ごとの件数）:
   ▪ 例: 「2000円のお弁当の会議用が何個、お祝い用が何個」のように、用途と価格帯の組み合わせごとに注文個数を集計し表示します。
   ▪ この明細はオペレーション改善に直結するため重要です。
   • グラフ表示（円グラフ、棒グラフなど）は現状では不要とし、基本的な数値と売上明細を優先します。
   5.3. CSV出力
   • 予約一覧ページの情報（お客様マスタ、商品マスタ、予約データを結合したもの）をCSV形式で出力できる機能を実装します。
   • 最も情報が集約されているページであるため、ここからのCSV出力が最も有用と判断されました。
6. 今後の検討事項（フェーズ2）
   6.1. RFM分析機能
   • 顧客の「最終購入日（Recency）」、「購入回数（Frequency）」、「購入金額（Monetary）」に基づき、VIP顧客の特定や顧客ランク付けを行うRFM分析機能の導入を検討します。
   • 指定期間（例: 1年間）における顧客の購入データに基づき、事前に定義された計算式とランク基準（例: 10万円以上でAランク）に従ってスコアやランクを付与し、顧客リストとして出力できることを目指します。
   • この機能はフェーズ2での実装を検討し、詳細な計算式やランク基準を後日提供することで、開発を進めることが可能です。導入には別途検証期間と費用が必要となります。
   6.2. 顧客向け予約システム（LINE連携含む）
   • 現在利用しているデリカート（外部サービス）に代わる、顧客が直接利用できる予約システムの構築を検討します。
   • LINE公式アカウントからの導線（外部リンク）やホームページからの導線を想定します。
   • LINEアプリ内での予約完結（埋め込み式）も技術的には可能ですが、セキュリティや費用・納期面で大規模になるため、まずは外部サイトとしての予約システムを優先して検討します。
   • 顧客向け予約システムから入力されたデータは、本管理システムへ自動で連携されます。
   • 顧客向け予約システムでは、画像付きのメニュー表示や、現在のデリカートで実装されているような仕出し特有のルール（例: 配達最低注文金額、配達可能エリア）の組み込みが必要となる可能性があります。これらの複雑なルールを組み込む場合、開発時間と費用が増加する可能性があります。
   • ランニングコストは、現在の管理システムと同じサーバー上で運用するため、追加費用は発生しない見込みです（月3000円～5000円程度の範囲）。
   • この機能もフェーズ2での実装を検討し、詳細な要件定義と別途見積もりが必要となります。
